<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Gaming Search Hub</title>
  <link rel="icon" href="Malek_logo__1_-removebg-preview copy.png" type="image/x-icon">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    /* General Reset & Background */
    body {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #1e1e2f, #252945, #191923);
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      flex-direction: column;
      position: relative;
      transition: all 0.3s ease;
    }

    /* Top Buttons Section */
    .top-buttons {
      position: absolute;
      top: 20px;
      right: 20px;
      display: flex;
      gap: 20px;
      justify-content: flex-end;
    }
    .top-btn {
      background-color: #1f4068;
      color: #fff;
      border: none;
      padding: 12px 20px;
      cursor: pointer;
      border-radius: 12px;
      font-size: 1rem;
      transition: background-color 0.3s, transform 0.3s;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .top-btn:hover {
      background-color: #162447;
      transform: translateY(-3px);
    }
    .top-btn i {
      font-size: 20px;
    }

    /* Points Display */
    #pointsDisplay {
      position: absolute;
      top: 20px;
      left: 20px;
      font-size: 20px;
      color: white;
      padding: 10px;
      background-color: black;
      opacity: 0.5;
    }

    /* Main Container */
    .container {
      text-align: center;
      animation: fadeIn 1s ease-in-out;
      width: 100%;
      max-width: 1000px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    /* Updated (Longer) Search Bar and Button */
    .search-container {
      width: 100%;
      max-width: 1200px;
      margin: 0 auto 20px;
      display: flex;
      align-items: stretch;
      overflow: hidden;
      border-radius: 30px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
    }
    .search-bar {
      flex: 1;
      padding: 20px 30px;
      font-size: 1.5rem;
      border: 2px solid #333;
      border-right: none;
      border-radius: 30px 0 0 30px;
      background-color: #222;
      color: #fff;
      outline: none;
      transition: all 0.3s ease;
    }
    .search-bar::placeholder {
      color: #888;
    }
    .search-bar:focus {
      border-color: #0078ff;
      box-shadow: 0 0 8px rgba(0, 120, 255, 0.5);
    }
    .search-icon-btn {
      padding: 20px 30px;
      border: none;
      background-color: #0078ff;
      color: #fff;
      font-size: 1.5rem;
      cursor: pointer;
      border-radius: 0 30px 30px 0;
      transition: background-color 0.3s ease, transform 0.3s ease;
    }
    .search-icon-btn:hover {
      background-color: #0056cc;
      transform: scale(1.05);
    }

    /* Welcome Section */
    .welcome-page {
      width: 100%;
      max-width: 600px;
      padding: 20px;
      border: 5px solid transparent;
      border-radius: 20px;
      background-color: #222;
      color: #fff;
      margin-bottom: 20px;
      text-align: center;
      font-size: 1.4rem;
    }

    /* Shortcut Buttons */
    .shortcuts {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 15px;
      margin-top: 20px;
    }
    .shortcut-btn {
      background-color: #1f4068;
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: 12px;
      font-size: 1rem;
      cursor: pointer;
      transition: background-color 0.3s, transform 0.3s;
    }
    .shortcut-btn:hover {
      background-color: #162447;
      transform: translateY(-3px);
    }

    /* Modal Styles (Common for Trade, News, Background) */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8);
      justify-content: center;
      align-items: center;
      z-index: 9999;
    }
    .modal-content {
      background-color: #1a1a2e;
      padding: 25px;
      border-radius: 12px;
      color: #fff;
      text-align: center;
      max-width: 500px;
      width: 100%;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    }
    .modal-content button {
      margin-top: 15px;
      background-color: #1f4068;
      color: #fff;
      border: none;
      padding: 12px 20px;
      cursor: pointer;
      border-radius: 8px;
      font-size: 1rem;
      transition: background-color 0.3s;
    }
    .modal-content button:hover {
      background-color: #162447;
    }

    /* News Modal (Scrollable News Items with Images) */
    .news-container {
      max-height: 300px;
      overflow-y: auto;
      margin: 15px 0;
      text-align: left;
    }
    .news-item {
      display: flex;
      gap: 15px;
      margin-bottom: 15px;
      border-bottom: 1px solid #333;
      padding-bottom: 10px;
    }
    .news-item img {
      width: 100px;
      height: auto;
      border-radius: 8px;
    }
    .news-item p {
      flex: 1;
      margin: 0;
      font-size: 1rem;
      line-height: 1.4;
    }

    /* Background Previews (Wallpaper Shop) */
    .background-previews {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
      max-height: 300px;
      overflow-y: auto;
    }
    .background-preview {
      width: 45%;
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s, opacity 0.3s;
      background-color: #222;
      padding: 5px;
      text-align: center;
    }
    .background-preview img {
      width: 100%;
      height: 120px;
      object-fit: contain;
      border-radius: 12px;
    }
    .background-preview p {
      margin: 5px 0 0;
      font-size: 0.9rem;
    }
    .background-preview span {
      display: block;
      font-size: 0.8rem;
      margin-top: 3px;
      color: #ccc;
    }
    .background-preview:hover {
      transform: scale(1.05);
      opacity: 0.9;
    }

    /* Owned Wallpapers Section */
    .owned-wallpapers {
      display: flex;
      flex-wrap: wrap;
      gap: 15px;
      margin-bottom: 15px;
      max-height: 200px;
      overflow-y: auto;
    }
    .owned-wallpaper {
      width: 45%;
      border-radius: 12px;
      overflow: hidden;
      cursor: pointer;
      transition: transform 0.3s, opacity 0.3s;
      background-color: #222;
      padding: 5px;
      text-align: center;
    }
    .owned-wallpaper img {
      width: 100%;
      height: 120px;
      object-fit: contain;
      border-radius: 12px;
    }
    .owned-wallpaper p {
      margin: 5px 0 0;
      font-size: 0.9rem;
    }
    .owned-wallpaper:hover {
      transform: scale(1.05);
      opacity: 0.9;
    }

    /* Trade Modal Styles */
    .trade-modal-content {
      background-color: #1a1a2e;
      padding: 25px;
      border-radius: 12px;
      color: #fff;
      text-align: center;
      max-width: 600px;
      width: 100%;
      font-size: 1rem;
      box-shadow: 0 4px 15px rgba(0, 0, 0, 0.4);
    }
    .trade-modal-content h2 {
      margin-top: 0;
    }
    .trade-section {
      text-align: left;
      margin: 15px 0;
    }
    .trade-section h3 {
      margin-bottom: 10px;
    }
    .trade-section select, .trade-section button {
      padding: 8px;
      font-size: 1rem;
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <!-- Top Buttons (Trade, News, Background) -->
  <div class="top-buttons">
    <!-- Trade Button (replaces Download) -->
    <button class="top-btn" onclick="showTradeModal()">
      <i class="fas fa-exchange-alt"></i> Trade
    </button>
    <button class="top-btn" onclick="showNewsSection()">
      <i class="fas fa-newspaper"></i> News
    </button>
    <button class="top-btn" onclick="showBackgroundSection()">
      <i class="fas fa-image"></i> Shop
    </button>
  </div>

  <!-- Points Display -->
  <div id="pointsDisplay">Points: 0</div>

  <!-- Main Content -->
  <div class="container">
    <h1 class="welcome-page">Welcome to Best Gaming Browser</h1>
    <form id="searchForm" action="https://www.google.com/search" method="get" onsubmit="handleSearch(event)">
      <div class="search-container">
        <input type="text" class="search-bar" name="q" placeholder="Search for gaming content...">
        <button type="submit" class="search-icon-btn">
          <i class="fas fa-search"></i>
        </button>
      </div>
    </form>
    <!-- Shortcut Buttons -->
    <div class="shortcuts">
      <button class="shortcut-btn" onclick="window.location.href='https://student.nis-blb.com/#/student'">
        <i class="fas fa-graduation-cap"></i> Student Portal
      </button>
      <button class="shortcut-btn" onclick="window.location.href='https://www.youtube.com'">
        <i class="fas fa-video"></i> YouTube
      </button>
      <button class="shortcut-btn" onclick="window.location.href='https://www.blooket.com'">
        <i class="fas fa-chart-line"></i> Blooket
      </button>
      <button class="shortcut-btn" onclick="window.location.href='https://www.fortnite.com/shop'">
        <i class="fas fa-shopping-cart"></i> Fortnite Shop
      </button>
    </div>
  </div>

  <!-- Modal for News (Scrollable News Items with Images) -->
  <div class="modal" id="newsSection">
    <div class="modal-content">
      <h2>Gaming News</h2>
      <div class="news-container">
        <!-- Example News Items -->
        <div class="news-item">
          <img src="news1.jpg" alt="News 1">
          <p>Fortnite: Skins' "Legacy Shoes" are being converted into free Kicks Cosmetics.</p>
        </div>
        <div class="news-item">
          <img src="news2.jpg" alt="News 2">
          <p>PlayStation: Servers were down for 20 hours and are now back online!</p>
        </div>
        <div class="news-item">
          <img src="news3.jpg" alt="News 3">
          <p>Fortnite: New Iron Man & Avatar skins are coming soon!</p>
        </div>
        <div class="news-item">
          <img src="news4.jpg" alt="News 4">
          <p>Fortnite: JUJUTSU KAISEN x FORTNITE collaboration in the shop!</p>
        </div>
        <div class="news-item">
          <img src="news5.jpg" alt="News 5">
          <p>GTA: GTA 6 has been canceled until Fall 2025.</p>
        </div>
        <div class="news-item">
          <img src="news6.jpg" alt="News 6">
          <p>Roblox: Farid now plays Roblox for some reason...</p>
        </div>
        <div class="news-item">
          <img src="news7.jpg" alt="News 7">
          <p>Roblox: A new design for Roblox has been released.</p>
        </div>
      </div>
      <button onclick="closeNewsSection()">Close</button>
    </div>
  </div>

  <!-- Modal for Background (Wallpaper Shop) -->
  <div class="modal" id="backgroundSection">
    <div class="modal-content">
      <h2>Background Shop</h2>
      <div class="background-previews"></div>
      <h3>Owned Wallpapers</h3>
      <div class="owned-wallpapers"></div>
      <button onclick="closeBackgroundSection()">Close</button>
    </div>
  </div>

  <!-- Modal for Trade -->
  <div class="modal" id="tradeModal">
    <div class="trade-modal-content">
      <h2>Trade Wallpapers</h2>
      <div id="tradeOffersSection">
        <h3>Your Trade Offers</h3>
        <div id="yourTradeOffers"></div>
      </div>
      <div id="createTradeSection" class="trade-section">
        <h3>Create New Trade Offer</h3>
        <form id="tradeForm">
          <div>
            <label for="offerSelect">Offer Wallpaper:</label>
            <select id="offerSelect" required></select>
          </div>
          <div>
            <label for="requestSelect">Request Wallpaper:</label>
            <select id="requestSelect" required></select>
          </div>
          <button type="submit">Submit Trade Offer</button>
        </form>
      </div>
      <button onclick="closeTradeModal()">Close</button>
    </div>
  </div>

  <script>
    /*********************
     * FIRST VISIT: ASK FOR REAL NAME
     *********************/
    if (!localStorage.getItem("realName")) {
      let realName = prompt("Welcome! Please enter your real name (for trade purposes):");
      if (realName) {
        localStorage.setItem("realName", realName);
      } else {
        alert("You must enter a name. Please reload the page and try again.");
      }
    }
    const realName = localStorage.getItem("realName");

    /*********************
     * POINTS & SEARCH SYSTEM
     *********************/
    let points = localStorage.getItem("points") ? parseInt(localStorage.getItem("points")) : 0;
    updatePointsDisplay();
    function updatePointsDisplay() {
      document.getElementById("pointsDisplay").textContent = `Points: ${points}`;
      localStorage.setItem("points", points);
    }

    // Spam Protection, Hourly Limit, and Captcha
    let searchTimestamps = localStorage.getItem("searchTimestamps") ? JSON.parse(localStorage.getItem("searchTimestamps")) : [];
    let hourlySearchCount = localStorage.getItem("hourlySearchCount") ? parseInt(localStorage.getItem("hourlySearchCount")) : 0;
    let lastHour = localStorage.getItem("lastHour") ? parseInt(localStorage.getItem("lastHour")) : 0;
    let captchaCount = 0;
    let lastSearchTime = localStorage.getItem("lastSearchTime") ? parseInt(localStorage.getItem("lastSearchTime")) : 0;
    let isBanned = localStorage.getItem("isBanned") === "true";
    let banEndTime = localStorage.getItem("banEndTime") ? parseInt(localStorage.getItem("banEndTime")) : null;

    if (banEndTime && Date.now() < banEndTime) {
      isBanned = true;
      setBanTimeout(banEndTime);
    } else {
      localStorage.removeItem("banEndTime");
      isBanned = false;
    }

    function setBanTimeout(banEndTime) {
      const remainingTime = banEndTime - Date.now();
      setTimeout(() => {
        isBanned = false;
        localStorage.removeItem("banEndTime");
        alert("Your ban has been lifted. Please search responsibly.");
      }, remainingTime);
    }

    function handleSpamProtection() {
      const now = Date.now();
      const timeFrame = 75 * 1000;
      const hourlyLimit = 10;
      searchTimestamps = searchTimestamps.filter(ts => now - ts <= timeFrame);
      searchTimestamps.push(now);
      localStorage.setItem("searchTimestamps", JSON.stringify(searchTimestamps));
      const currentHour = Math.floor(now / (60 * 60 * 1000));
      if (currentHour !== lastHour) {
        hourlySearchCount = 0;
        lastHour = currentHour;
        localStorage.setItem("lastHour", lastHour);
      }
      if (hourlySearchCount >= hourlyLimit) {
        alert("You've reached the hourly search limit for earning points. Try again later.");
        return false;
      }
      if (searchTimestamps.length > 6) {
        isBanned = true;
        banEndTime = now + 20 * 60 * 1000;
        localStorage.setItem("banEndTime", banEndTime);
        localStorage.setItem("isBanned", true);
        alert("You have been banned for spamming searches!");
        setBanTimeout(banEndTime);
        return false;
      }
      hourlySearchCount++;
      localStorage.setItem("hourlySearchCount", hourlySearchCount);
      return true;
    }

    function checkCaptcha() {
      if (captchaCount >= 7) {
        const userInput = prompt("Please solve this captcha: What is 5 + 3?");
        if (userInput !== "8") {
          alert("Captcha failed. Please try again.");
          return false;
        }
        captchaCount = 0;
      }
      captchaCount++;
      return true;
    }

    function handleSearch(event) {
      event.preventDefault();
      const now = Date.now();
      if (isBanned) {
        alert(`You are banned! Try again after ${Math.ceil((banEndTime - now) / 60000)} minutes.`);
        return;
      }
      const popupTest = window.open("", "_blank");
      if (!popupTest || popupTest.closed || typeof popupTest.closed === "undefined") {
        alert("Pop-ups are blocked! Enable them to earn points.");
        return;
      }
      popupTest.close();
      if (lastSearchTime && now - lastSearchTime < 10000) {
        alert(`Please wait ${Math.ceil((10000 - (now - lastSearchTime)) / 1000)} seconds before searching again.`);
        return;
      }
      if (!handleSpamProtection() || !checkCaptcha()) return;
      lastSearchTime = now;
      localStorage.setItem("lastSearchTime", lastSearchTime);
      increasePoints();
      document.getElementById("searchForm").submit();
    }

    function increasePoints() {
      const randomPoints = Math.floor(Math.random() * 5) + 1;
      points += randomPoints;
      updatePointsDisplay();
      alert(`You earned ${randomPoints} points!`);
    }

    /*********************
     * BACKGROUND (WALLPAPER) SHOP
     *********************/
    const wallpapersShop = [
      {
        id: 2,
        name: "Fortnite Chapter 6",
        image: "fnc6.png",
        cost: 0,
        requiresCode: false
      },
      {
        id: 3,
        name: "NANA",
        image: "banana.jpeg",
        cost: null,
        requiresCode: true,
        code: "GGP-PPP",
        realMoneyCost: "$10"
      },
      {
        id: 4,
        name: "Fortnite OG Season 1",
        image: "fortniteog1.jpeg",
        cost: 50,
        requiresCode: false
      },
      {
        id: 5,
        name: "Fortnite OG Season 2",
        image: "fortniteog2.jpeg",
        cost: 50,
        requiresCode: false
      },
      {
        id: 6,
        name: "Fortnite Item Shop",
        image: "fnis.png",
        cost: 25,
        requiresCode: false
      },
      {
        id: 7,
        name: "MINI BOX PVP",
        image: "Beyond.PNG",
        cost: null,
        requiresCode: true,
        code: "TT3-PPP",
        realMoneyCost: "$10"
      },
    ];

    let purchasedWallpapers = localStorage.getItem("purchasedWallpapers")
      ? JSON.parse(localStorage.getItem("purchasedWallpapers"))
      : {};
    wallpapersShop.forEach(w => {
      if (w.cost === 0) {
        purchasedWallpapers[w.id] = true;
      }
    });
    localStorage.setItem("purchasedWallpapers", JSON.stringify(purchasedWallpapers));

    let usedWallpaperCodes = localStorage.getItem("usedWallpaperCodes")
      ? JSON.parse(localStorage.getItem("usedWallpaperCodes"))
      : [];
    localStorage.setItem("usedWallpaperCodes", JSON.stringify(usedWallpaperCodes));

    function changeBackground(image) {
      document.body.style.backgroundImage = `url(${image})`;
      localStorage.setItem("background", image);
    }

    function handleWallpaperSelection(wallpaper) {
      if (purchasedWallpapers[wallpaper.id]) {
        changeBackground(wallpaper.image);
      } else {
        if (wallpaper.requiresCode) {
          const userCode = prompt("Enter redemption code for " + wallpaper.name + ":");
          if (userCode && userCode === wallpaper.code) {
            if (usedWallpaperCodes.includes(userCode)) {
              alert("This code has already been used.");
            } else {
              usedWallpaperCodes.push(userCode);
              localStorage.setItem("usedWallpaperCodes", JSON.stringify(usedWallpaperCodes));
              purchasedWallpapers[wallpaper.id] = true;
              localStorage.setItem("purchasedWallpapers", JSON.stringify(purchasedWallpapers));
              alert(wallpaper.name + " unlocked!");
              changeBackground(wallpaper.image);
              populateWallpapersShop();
              populateOwnedWallpapers();
            }
          } else {
            alert("Invalid code!");
          }
        } else {
          if (points >= wallpaper.cost) {
            if (confirm("This wallpaper costs " + wallpaper.cost + " points. Do you want to purchase it?")) {
              points -= wallpaper.cost;
              updatePointsDisplay();
              purchasedWallpapers[wallpaper.id] = true;
              localStorage.setItem("purchasedWallpapers", JSON.stringify(purchasedWallpapers));
              alert(wallpaper.name + " purchased!");
              changeBackground(wallpaper.image);
              populateWallpapersShop();
              populateOwnedWallpapers();
            }
          } else {
            alert("Not enough points to purchase this wallpaper.");
          }
        }
      }
    }

    function populateWallpapersShop() {
      const container = document.querySelector(".background-previews");
      container.innerHTML = "";
      wallpapersShop.forEach(wallpaper => {
        const previewDiv = document.createElement("div");
        previewDiv.className = "background-preview";
        const img = document.createElement("img");
        img.src = wallpaper.image;
        previewDiv.appendChild(img);
        const nameP = document.createElement("p");
        nameP.textContent = wallpaper.name;
        previewDiv.appendChild(nameP);
        const costP = document.createElement("span");
        if (wallpaper.cost === 0) {
          costP.textContent = "Free";
        } else if (wallpaper.requiresCode) {
          costP.textContent = wallpaper.realMoneyCost ? "Real Money: " + wallpaper.realMoneyCost : "Requires Code";
        } else {
          costP.textContent = "Cost: " + wallpaper.cost + " points";
        }
        previewDiv.appendChild(costP);
        previewDiv.addEventListener("click", function () {
          handleWallpaperSelection(wallpaper);
        });
        container.appendChild(previewDiv);
      });
    }

    function populateOwnedWallpapers() {
      const container = document.querySelector(".owned-wallpapers");
      container.innerHTML = "";
      wallpapersShop.forEach(wallpaper => {
        if (purchasedWallpapers[wallpaper.id]) {
          const ownedDiv = document.createElement("div");
          ownedDiv.className = "owned-wallpaper";
          const img = document.createElement("img");
          img.src = wallpaper.image;
          ownedDiv.appendChild(img);
          const nameP = document.createElement("p");
          nameP.textContent = wallpaper.name;
          ownedDiv.appendChild(nameP);
          ownedDiv.addEventListener("click", function () {
            changeBackground(wallpaper.image);
          });
          container.appendChild(ownedDiv);
        }
      });
    }

    /*********************
     * TRADE SYSTEM
     *********************/
    // We'll store trade offers in localStorage under the key "tradeOffers".
    // Each trade offer is an object: { id, traderName, offerWallpaperId, requestWallpaperId }
    function getTradeOffers() {
      return localStorage.getItem("tradeOffers")
        ? JSON.parse(localStorage.getItem("tradeOffers"))
        : [];
    }
    function saveTradeOffers(offers) {
      localStorage.setItem("tradeOffers", JSON.stringify(offers));
    }
    function createTradeOffer(offer) {
      let offers = getTradeOffers();
      offers.push(offer);
      saveTradeOffers(offers);
    }
    function populateTradeOffers() {
      const container = document.getElementById("yourTradeOffers");
      container.innerHTML = "";
      let offers = getTradeOffers();
      // Filter for offers created by this user (by realName)
      offers = offers.filter(o => o.traderName === realName);
      if (offers.length === 0) {
        container.innerHTML = "<p>You have no trade offers.</p>";
        return;
      }
      offers.forEach(o => {
        // Get wallpaper objects from wallpapersShop by id
        const offerWall = wallpapersShop.find(w => w.id === o.offerWallpaperId);
        const requestWall = wallpapersShop.find(w => w.id === o.requestWallpaperId);
        const div = document.createElement("div");
        div.style.border = "1px solid #333";
        div.style.marginBottom = "10px";
        div.style.padding = "5px";
        div.innerHTML = `<strong>Offer:</strong> ${offerWall ? offerWall.name : "Unknown"}<br>
                         <strong>Request:</strong> ${requestWall ? requestWall.name : "Unknown"}`;
        container.appendChild(div);
      });
    }
    function populateTradeFormSelects() {
      // For the offer dropdown, list wallpapers the user owns.
      const offerSelect = document.getElementById("offerSelect");
      const requestSelect = document.getElementById("requestSelect");
      offerSelect.innerHTML = "";
      requestSelect.innerHTML = "";
      wallpapersShop.forEach(w => {
        if (purchasedWallpapers[w.id]) {
          const opt = document.createElement("option");
          opt.value = w.id;
          opt.textContent = w.name;
          offerSelect.appendChild(opt);
        } else {
          // For the request dropdown, list wallpapers the user does NOT own.
          const opt = document.createElement("option");
          opt.value = w.id;
          opt.textContent = w.name;
          requestSelect.appendChild(opt);
        }
      });
    }
    document.getElementById("tradeForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const offerId = parseInt(document.getElementById("offerSelect").value);
      const requestId = parseInt(document.getElementById("requestSelect").value);
      if (offerId === requestId) {
        alert("You cannot trade for the same wallpaper.");
        return;
      }
      const newOffer = {
        id: Date.now(),
        traderName: realName,
        offerWallpaperId: offerId,
        requestWallpaperId: requestId
      };
      createTradeOffer(newOffer);
      alert("Trade offer created!");
      populateTradeOffers();
      // Optionally, reset the form
      document.getElementById("tradeForm").reset();
      populateTradeFormSelects();
    });

    /*********************
     * MODAL CONTROL FUNCTIONS
     *********************/
    function showNewsSection() {
      document.getElementById("newsSection").style.display = "flex";
    }
    function closeNewsSection() {
      document.getElementById("newsSection").style.display = "none";
    }
    function showBackgroundSection() {
      populateWallpapersShop();
      populateOwnedWallpapers();
      document.getElementById("backgroundSection").style.display = "flex";
    }
    function closeBackgroundSection() {
      document.getElementById("backgroundSection").style.display = "none";
    }
    function showTradeModal() {
      populateTradeFormSelects();
      populateTradeOffers();
      document.getElementById("tradeModal").style.display = "flex";
    }
    function closeTradeModal() {
      document.getElementById("tradeModal").style.display = "none";
    }

    /*********************
     * OTHER MODAL FUNCTIONS (if needed)
     *********************/
    // (Download modal is no longer used; you can remove it if desired)

    document.getElementById("searchForm").addEventListener("submit", handleSearch);

    if (localStorage.getItem("background")) {
      document.body.style.backgroundImage = `url(${localStorage.getItem("background")})`;
    }
  </script>
</body>
</html>
